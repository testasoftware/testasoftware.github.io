<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 3.11.1"/><title data-react-helmet="true"></title><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){if(void 0===e.target.dataset.mainImage)return;if(void 0===e.target.dataset.gatsbyImageSsr)return;const t=e.target;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="icon" href="/favicon-32x32.png?v=8704c9db0cbb3a15ccc9b40440bf50bc" type="image/png"/><link rel="icon" href="/favicon.svg?v=8704c9db0cbb3a15ccc9b40440bf50bc" type="image/svg+xml"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=8704c9db0cbb3a15ccc9b40440bf50bc"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=8704c9db0cbb3a15ccc9b40440bf50bc"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=8704c9db0cbb3a15ccc9b40440bf50bc"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=8704c9db0cbb3a15ccc9b40440bf50bc"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=8704c9db0cbb3a15ccc9b40440bf50bc"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=8704c9db0cbb3a15ccc9b40440bf50bc"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=8704c9db0cbb3a15ccc9b40440bf50bc"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=8704c9db0cbb3a15ccc9b40440bf50bc"/><link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700" rel="stylesheet"/><link href="/assets/css/nucleo-icons.css" rel="stylesheet"/><link href="/assets/css/nucleo-svg.css" rel="stylesheet"/><script src="https://kit.fontawesome.com/42d5adcbca.js" crossorigin="anonymous"></script><link id="pagestyle" href="/assets/css/soft-design-system-pro.css?v=1.0.8" rel="stylesheet"/><link as="script" rel="preload" href="/webpack-runtime-e00245cfc13ae4adde82.js"/><link as="script" rel="preload" href="/framework-f4203fd1a3c11369dc16.js"/><link as="script" rel="preload" href="/app-d754f4d739cc1001c986.js"/><link as="script" rel="preload" href="/component---src-pages-blog-markdown-remark-frontmatter-slug-tsx-81b9ea67689d54fbd370.js"/><link as="fetch" rel="preload" href="/page-data/blog/2015-09-01-thinking-functionally-with-linq/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="container position-sticky z-index-sticky top-0"><div class="row"><div class="col-12"><nav class="navbar navbar-expand-lg blur blur-rounded position-absolute my-3 top-0 border-bottom py-3 z-index-3 shadow my-3 py-2 start-0 end-0 mx-4"><div class="container"><a class="navbar-brand" href="/"><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained"><div style="max-width:197px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;22&#x27; width=&#x27;197&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#080808;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="/static/d9d346395dd42b2dc0a9adff69895401/0d3fe/testasoftware-lambda.webp 49w,/static/d9d346395dd42b2dc0a9adff69895401/3c899/testasoftware-lambda.webp 99w,/static/d9d346395dd42b2dc0a9adff69895401/962e2/testasoftware-lambda.webp 197w,/static/d9d346395dd42b2dc0a9adff69895401/37b4c/testasoftware-lambda.webp 394w" sizes="(min-width: 197px) 197px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 197px) 197px, 100vw" decoding="async" loading="lazy" data-src="/static/d9d346395dd42b2dc0a9adff69895401/74f68/testasoftware-lambda.svg" data-srcset="/static/d9d346395dd42b2dc0a9adff69895401/0bf4c/testasoftware-lambda.svg 49w,/static/d9d346395dd42b2dc0a9adff69895401/a577b/testasoftware-lambda.svg 99w,/static/d9d346395dd42b2dc0a9adff69895401/74f68/testasoftware-lambda.svg 197w,/static/d9d346395dd42b2dc0a9adff69895401/3979d/testasoftware-lambda.svg 394w" alt="Testa Software"/></picture><noscript><picture><source type="image/webp" srcSet="/static/d9d346395dd42b2dc0a9adff69895401/0d3fe/testasoftware-lambda.webp 49w,/static/d9d346395dd42b2dc0a9adff69895401/3c899/testasoftware-lambda.webp 99w,/static/d9d346395dd42b2dc0a9adff69895401/962e2/testasoftware-lambda.webp 197w,/static/d9d346395dd42b2dc0a9adff69895401/37b4c/testasoftware-lambda.webp 394w" sizes="(min-width: 197px) 197px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 197px) 197px, 100vw" decoding="async" loading="lazy" src="/static/d9d346395dd42b2dc0a9adff69895401/74f68/testasoftware-lambda.svg" srcSet="/static/d9d346395dd42b2dc0a9adff69895401/0bf4c/testasoftware-lambda.svg 49w,/static/d9d346395dd42b2dc0a9adff69895401/a577b/testasoftware-lambda.svg 99w,/static/d9d346395dd42b2dc0a9adff69895401/74f68/testasoftware-lambda.svg 197w,/static/d9d346395dd42b2dc0a9adff69895401/3979d/testasoftware-lambda.svg 394w" alt="Testa Software"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1)}}</script></div></a><button class="navbar-toggler shadow-none ms-2" type="button" data-bs-toggle="collapse" data-bs-target="#navigation" aria-controls="navigation" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon mt-2"><span class="navbar-toggler-bar bar1"></span><span class="navbar-toggler-bar bar2"></span><span class="navbar-toggler-bar bar3"></span></span></button><div class="collapse navbar-collapse w-100 pt-3 pb-2 py-lg-0" id="navigation"><ul class="navbar-nav navbar-nav-hover mx-auto"><li class="nav-item mx-2"><a class="nav-link ps-2 d-flex justify-content-between cursor-pointer align-items-center" href="/about">About</a></li><li class="nav-item mx-2"><a class="nav-link ps-2 d-flex justify-content-between cursor-pointer align-items-center" href="/resume">Resume</a></li><li class="nav-item mx-2"><a class="nav-link ps-2 d-flex justify-content-between cursor-pointer align-items-center" href="/blog">Blog</a></li><li class="nav-item mx-2"><a class="nav-link ps-2 d-flex justify-content-between cursor-pointer align-items-center" href="https://github.com/stesta">GitHub</a></li></ul></div></div></nav></div></div></div><section class="py-sm-7 py-5 position-relative"><div class="container"><div class="row"><div class="col-12 mx-auto"><div class="blog-post-container"><div class="blog-post"><h1>Thinking Functionally with LINQ</h1><h2>September 01, 2015</h2><div class="blog-post-content"><p>What would you do if I asked you to complete a task across a collection of objects without using a foreach loop? Or any loop<!--more-->ing construct at all for that matter? More importantly, why does it matter?</p>
<p>In my last post, <a href="/steve/blog/linq-helpers-for-IEnumerable/">Linq Helpers for IEnumerable</a>, I mentioned that LINQ to Objects was particularly appealing to me. Per MSDN (and they're spot on), LINQ queries offer three main advantages over the more procedural foreach loops:</p>
<ol>
<li>They are more concise and readable, especially when filtering multiple conditions.</li>
<li>They provide powerful filtering, ordering, and grouping capabilities with a minimum of application code.</li>
<li>They can be ported to other data sources with little or no modification</li>
</ol>
<p>For me LINQ means that I can take piece of procedural code, such as a complex series of foreach loops, and break them down into clear declarative statements. Foreach loops certainly have their place, but can often be replaced by functional statements that make code much more readable.</p>
<h3>The Map Function</h3>
<p>Before we dig in to a LINQ example, let's go over a couple basic functions. In functional programming, one of the most common functions is the map function. Wikipedia has a nice concise definition.</p>
<blockquote>
<p>map is the name of a higher-order function that applies a given function to each element of a list, returning a list of results. It is often called apply-to-all when considered in functional form.</p>
</blockquote>
<p>The effective impact of map is that it allows functional programmers to avoid looping constructs while working with lists and define the logic in a declarative way. This what a map looks like in Haskell:</p>
<script src="https://gist.github.com/stesta/e9a861350cf773818f81.js"></script>  
<p>(Just a quick side note, this code will not actually manipulate elements in a list. In the functional world everything is immutable. So in this case we're actually creating an entirely new list.)</p>
<h3>The Filter Function</h3>
<p>The filter function is also another common function we can use against a list to pare it down to the items we care about. Once again Wikipedia provides us with a nice definition.</p>
<blockquote>
<p>filter is a higher-order function that processes a data structure (typically a list) in some order to produce a new data structure containing exactly those elements of the original data structure for which a given predicate returns the boolean value true.</p>
</blockquote>
<script src="https://gist.github.com/stesta/15bbbcfd59fb9c861b90.js"></script>  
<h2>Functional LINQ</h2>
<p>So how do these concepts transfer to LINQ? Here's a real-world example. I came across this bit of code in my day job. It has been modified only slightly to make things a little less complex and the problem space a little more understandable. There's nothing inherently wrong with the code. After all, it does in fact work. It was just written by someone who is used to thinking imperatively versus functionally. The biggest issue I have with the code is that it's difficult to read and understand at a glance. As developers, we much more of our time reading code as opposed to writing code. That makes it extremely important that we write concise and understandable code.</p>
<p>Here is the basic gist of what is happening in the code I came across. In our system, Users can follow Accounts (companies). By following an Account a User is essentially following a list of people who are employed by that Account. To summarize what's going on, the code in question is attempting to get parse a list of paged search results. The list of results contains a list of Users who are following the searched account(s). For each person under those accounts some action is performed.</p>
<script src="https://gist.github.com/stesta/3bfabceae3adc7462d3a.js"></script>  
<p>We can actually cut out almost all of the foreach logic by employing the functional concepts that we mentioned earlier. In our case, the foreach loops are really just querying some data. LINQ makes a lot of sense here. After all LINQ does stand for Language INtegrated Query. In order to begin to harness the true power of LINQ your view needs to be shifted. LINQ isn't merely a SQL in code. It's a query language for sure, but one that it both extremely expressive and functionally oriented. Especially when using the fluent syntax.</p>
<p>The LINQ Select method corresponds almost directly to map. The LINQ Where clause corresponds closely to filter. In the example below, I also make use of the SelectMany clause. The basic idea behind a SelectMany is that it will project each element of a sequence to an IEnumerable&#x3C;T> and flatten the resulting sequences into one sequence. For example, when the paged list of users is returned in the results instead of getting back an IEnumberable&#x3C;IEnumerable&#x3C;User>> (a list of lists) we just get back a single concatenated IEnumerable&#x3C;User></p>
<script src="https://gist.github.com/stesta/3976b8fd869db359e284.js"></script>  
<p>Note that at the end of the code we are in fact using a ForEach mentioned in my last post. If you paid close attention you'll remember that a ForEach that executes an Action is completely acceptable use case. In the case of Actions we're not really selecting or projecting in a functional manner.</p>
<p>It's possible to get even terser with the code. We can get the logic down to six lines of code (or one giant one-liner depending on how you look at it). However, generally I like to stick to the previous code example style just to keep things as clear as possible.</p>
<script src="https://gist.github.com/stesta/cb67f52a12f6af8a258e.js"></script>  
<p>That's all for now! Happy coding!</p></div></div></div></div></div></div></section><footer class="footer pb-5 pt-5"><hr class="horizontal dark mb-5"/><div class="container"><div class="row"><div class="col-lg-3"><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained"><div style="max-width:197px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;22&#x27; width=&#x27;197&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#080808;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="/static/d9d346395dd42b2dc0a9adff69895401/0d3fe/testasoftware-lambda.webp 49w,/static/d9d346395dd42b2dc0a9adff69895401/3c899/testasoftware-lambda.webp 99w,/static/d9d346395dd42b2dc0a9adff69895401/962e2/testasoftware-lambda.webp 197w,/static/d9d346395dd42b2dc0a9adff69895401/37b4c/testasoftware-lambda.webp 394w" sizes="(min-width: 197px) 197px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 197px) 197px, 100vw" decoding="async" loading="lazy" data-src="/static/d9d346395dd42b2dc0a9adff69895401/74f68/testasoftware-lambda.svg" data-srcset="/static/d9d346395dd42b2dc0a9adff69895401/0bf4c/testasoftware-lambda.svg 49w,/static/d9d346395dd42b2dc0a9adff69895401/a577b/testasoftware-lambda.svg 99w,/static/d9d346395dd42b2dc0a9adff69895401/74f68/testasoftware-lambda.svg 197w,/static/d9d346395dd42b2dc0a9adff69895401/3979d/testasoftware-lambda.svg 394w" alt="Testa Software"/></picture><noscript><picture><source type="image/webp" srcSet="/static/d9d346395dd42b2dc0a9adff69895401/0d3fe/testasoftware-lambda.webp 49w,/static/d9d346395dd42b2dc0a9adff69895401/3c899/testasoftware-lambda.webp 99w,/static/d9d346395dd42b2dc0a9adff69895401/962e2/testasoftware-lambda.webp 197w,/static/d9d346395dd42b2dc0a9adff69895401/37b4c/testasoftware-lambda.webp 394w" sizes="(min-width: 197px) 197px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 197px) 197px, 100vw" decoding="async" loading="lazy" src="/static/d9d346395dd42b2dc0a9adff69895401/74f68/testasoftware-lambda.svg" srcSet="/static/d9d346395dd42b2dc0a9adff69895401/0bf4c/testasoftware-lambda.svg 49w,/static/d9d346395dd42b2dc0a9adff69895401/a577b/testasoftware-lambda.svg 99w,/static/d9d346395dd42b2dc0a9adff69895401/74f68/testasoftware-lambda.svg 197w,/static/d9d346395dd42b2dc0a9adff69895401/3979d/testasoftware-lambda.svg 394w" alt="Testa Software"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1)}}</script></div></div><div class="col-lg-6 text-center"><ul class="nav flex-row align-items-center mb-5 mt-sm-0 justify-content-center"><li class="nav-item"><a class="nav-link" href="/">Home</a></li><li class="nav-item"><a class="nav-link" href="/about">About Me</a></li><li class="nav-item"><a class="nav-link" href="/resume">Resume</a></li><li class="nav-item"><a class="nav-link" href="/blog">Blog</a></li></ul><p class="mb-0">© <!-- -->2021<!-- --> Testa Software</p></div><div class="col-lg-3 text-end"><a href="javascript:;" target="_blank" class="text-secondary me-xl-4 me-4"><span class="fab fa-github text-lg"></span></a><a href="javascript:;" target="_blank" class="text-secondary me-xl-4 me-4"><span class="fab fa-twitter text-lg"></span></a><a href="javascript:;" target="_blank" class="text-secondary me-xl-4 me-4"><span class="fab fa-linkedin text-lg"></span></a></div></div></div></footer></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script src="/assets/js/core/popper.min.js" type="text/javascript"></script><script src="/assets/js/core/bootstrap.min.js" type="text/javascript"></script><script src="/assets/js/plugins/perfect-scrollbar.min.js"></script><script src="/assets/js/plugins/typedjs.js"></script><script src="/assets/js/plugins/countup.min.js"></script><script src="/assets/js/plugins/rellax.min.js"></script><script src="/assets/js/plugins/tilt.min.js"></script><script src="/assets/js/plugins/choices.min.js"></script><script src="/assets/js/plugins/parallax.min.js"></script><script src="/assets/js/plugins/nouislider.min.js" type="text/javascript"></script><script src="/assets/js/plugins/glidejs.min.js" type="text/javascript"></script><script src="/assets/js/plugins/anime.min.js" type="text/javascript"></script><script src="/assets/js/plugins/chartjs.min.js"></script><script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDTTfWur0PDbZWPr7Pmq8K3jiDp0_xUziI"></script><script src="/assets/js/soft-design-system-pro.min.js?v=1.0.8" type="text/javascript"></script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/2015-09-01-thinking-functionally-with-linq/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-20d9b08b6749f5e91b9a.js"],"app":["/app-d754f4d739cc1001c986.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-14546a0161e20ed3b14f.js"],"component---src-pages-about-tsx":["/component---src-pages-about-tsx-b6a677cd70788cfefbe7.js"],"component---src-pages-blog-index-tsx":["/component---src-pages-blog-index-tsx-4f63af1a2a033ade5cf0.js"],"component---src-pages-blog-markdown-remark-frontmatter-slug-tsx":["/component---src-pages-blog-markdown-remark-frontmatter-slug-tsx-81b9ea67689d54fbd370.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-14ec7d027de18d459706.js"],"component---src-pages-resume-tsx":["/component---src-pages-resume-tsx-f1e0f07306daf32d019d.js"]};/*]]>*/</script><script src="/polyfill-20d9b08b6749f5e91b9a.js" nomodule=""></script><script src="/component---src-pages-blog-markdown-remark-frontmatter-slug-tsx-81b9ea67689d54fbd370.js" async=""></script><script src="/app-d754f4d739cc1001c986.js" async=""></script><script src="/framework-f4203fd1a3c11369dc16.js" async=""></script><script src="/webpack-runtime-e00245cfc13ae4adde82.js" async=""></script></body></html>